# YouTube Chat Overlay (Chrome Extension)

YouTube の既存チャット UI をそのまま表示せず、チャット iframe の新着を監視して独自オーバーレイとして描画する拡張機能です。
拡張アイコンの `popup.html` から、全画面/シアター/通常に加えて「チャットパネル開/閉」ごとに設定を分けて調整できます。

## 表示仕様

- 表示モード:
  - 全画面
  - シアターモード
- 非表示モード:
  - 通常表示
- レイアウト:
  - 左側縦レーン
  - `アバター + @name + 本文` の 1 行構成
  - 太字 + 縁取り
- 表示寿命:
  - 9 秒でフェードアウト
  - 最大 8 件まで表示（超過分は古い順に即削除）

## popupで調整できる項目

- 表示モードの有効化（全画面/シアター/通常）
- 編集対象モードの切り替え（全画面/シアター/通常）
- チャットパネル状態の切り替え（開いている時/閉じている時）
- 文字サイズ/太さ/不透明度
- アバター表示ON/OFF・サイズ
- レーン幅/行間
- 横/縦アンカー
- 横/縦オフセット
  - オフセットはプレイヤーサイズに合わせて自動スケール（解像度が変わっても相対位置を維持）
  - プレイヤー上でコメントレーンをドラッグして直接位置調整（ドラッグ中は枠を表示）
- 最大表示件数
- 表示時間/フェード時間
- 連続フェード間隔（1件ずつ消える間隔）
- 縁取り太さ
- 背景不透明度
- 名前表示ON/OFF

## 対応イベント

- 通常コメント
- スーパーチャット
- メンバー加入メッセージ
- スーパーステッカー
- 視聴者向けお知らせ
- モード変更メッセージ

## 対応配信種別

- ライブ配信
- ライブチャットリプレイ付きアーカイブ

## ファイル構成

- `content-config.js`: 定数/デフォルト値/設定正規化
- `content-dom.js`: モード判定とDOM探索ユーティリティ
- `content-chat-source.js`: チャット取得元（iframe監視/隠しiframe）管理
- `content-message-flow.js`: メッセージキュー/表示寿命/ダミー行管理
- `content-overlay-ui.js`: オーバーレイUIとドラッグ編集/配置制御
- `content.js`: オーバーレイUI制御とライフサイクル統合
- `content-parser.js`: チャットrenderer解析（本文/絵文字/バッジの正規化）
- `content-renderer.js`: オーバーレイ行DOM生成とスタイル適用

## 使い方

1. Chrome で `chrome://extensions/` を開く
2. 右上の「デベロッパーモード」を ON
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. このフォルダ（`yt-chat`）を選択
5. YouTube のライブ配信またはリプレイ動画を開き、全画面またはシアターモードに切り替える
6. Chrome ツールバーの拡張アイコンから本拡張の popup を開き、見た目を調整する

## 既知の制約

- YouTube 側 DOM 構造が大きく変更された場合は、取得セレクタの更新が必要です。
- ライブチャット iframe にアクセスできない場合（ページ状態や仕様変更時）は、静かに無効化されます。
